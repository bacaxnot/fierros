# Exercise Metrics Endpoints Implementation Plan

Based on the spec defined in `apps/api/_specs_/routes/exercise-metrics.md`.

## Requirements

1. **GET /exercise-metrics**: List all available exercise metrics (reference data). No query parameters, no user-scoped filtering. Returns `ExerciseMetricPrimitives[]` wrapped in a `{ data }` envelope.

## Folder Structure

```
apps/api/src/
├── controllers/
│   └── exercise-metrics/
│       └── get-exercise-metrics.ts      # NEW
├── routes/
│   └── exercise-metrics.ts              # NEW
└── index.ts                             # UPDATE - register route
```

## Implementation Details

### Controllers

#### `controllers/exercise-metrics/get-exercise-metrics.ts`

```typescript
import { container } from "@repo/core/container";
import { SearchAllExerciseMetrics } from "@repo/core/contexts/training/exercise-metrics/application/search-all-exercise-metrics.usecase";
import { DomainError } from "@repo/core/shared/domain/domain-error";
import { factory } from "~/lib/factory";
import { domainError, internalServerError, json } from "~/lib/http-response";

export const getExerciseMetricsHandlers = factory.createHandlers(async (c) => {
  try {
    const useCase = container.get(SearchAllExerciseMetrics);
    const data = await useCase.execute();
    return json(c, { data });
  } catch (error: unknown) {
    if (error instanceof DomainError) {
      return domainError(c, error, 400);
    }
    return internalServerError(c);
  }
});
```

**Notes:**
- `SearchAllExerciseMetrics.execute()` takes no parameters and returns `Promise<ExerciseMetricPrimitives[]>`.
- Response shape: `{ data: ExerciseMetricPrimitives[] }` with status 200.
- No user context needed — exercise metrics are reference data, not user-scoped.

### Routes

#### `routes/exercise-metrics.ts`

```typescript
import { Hono } from "hono";
import { getExerciseMetricsHandlers } from "~/controllers/exercise-metrics/get-exercise-metrics";

export const exerciseMetricsApp = new Hono()
  .get("/", ...getExerciseMetricsHandlers);

export type ExerciseMetricsAppType = typeof exerciseMetricsApp;
```

### Index Registration

#### `index.ts`

Add the import and route registration to `apps/api/src/index.ts`:

**Add import** (after existing imports):

```typescript
import { exerciseMetricsApp } from "~/routes/exercise-metrics";
```

**Register route** — chain `.route("/exercise-metrics", exerciseMetricsApp)` on the app, replacing the TODO comment block:

```typescript
  // Health check
  .get("/health", (c) => c.json({ status: "ok" }))
  // Domain routes
  .route("/exercise-metrics", exerciseMetricsApp);
```

This removes the `// TODO: Add domain routes here` comment and the commented-out example, chaining the route directly onto the app builder.

## Package Exports Note

The import `@repo/core/contexts/training/exercise-metrics/application/search-all-exercise-metrics.usecase` requires a matching export entry in `packages/core/package.json`. If not yet present, add:

```json
"./contexts/*": "./src/contexts/*.ts"
```

to the `"exports"` map in `packages/core/package.json`.
